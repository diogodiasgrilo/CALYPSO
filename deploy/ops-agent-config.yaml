# Google Cloud Ops Agent - Custom Configuration for CALYPSO
#
# Collects:
# 1. All systemd journal logs (filtered at dashboard level for meic_tf)
# 2. Bot file log at /opt/calypso/logs/meic_tf/bot.log
# 3. Shared monitor log at /opt/calypso/logs/monitor.log
#
# Deploy:
#   sudo cp /opt/calypso/deploy/ops-agent-config.yaml /etc/google-cloud-ops-agent/config.yaml
#   sudo systemctl restart google-cloud-ops-agent
#
# Last Updated: 2026-02-26

logging:
  receivers:
    # Capture all systemd journal logs (meic_tf filtered at dashboard level)
    journal:
      type: systemd_journald

    # Capture the bot's dedicated log file
    meic_tf_logfile:
      type: files
      include_paths:
        - /opt/calypso/logs/meic_tf/bot.log

    # Capture the shared monitor log (all bots)
    monitor_log:
      type: files
      include_paths:
        - /opt/calypso/logs/monitor.log

  service:
    pipelines:
      journal_pipeline:
        receivers:
          - journal

      meic_tf_logfile_pipeline:
        receivers:
          - meic_tf_logfile

      monitor_pipeline:
        receivers:
          - monitor_log

metrics:
  receivers:
    hostmetrics:
      type: hostmetrics
      collection_interval: 60s

  processors:
    metrics_filter:
      type: exclude_metrics
      metrics_pattern: []

  service:
    pipelines:
      default_pipeline:
        receivers:
          - hostmetrics
        processors:
          - metrics_filter
